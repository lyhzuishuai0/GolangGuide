# Linux系统命令

### 系统目录结构

1. 一切皆文件
2. 根目录`/`，所有的文件都挂载在这个节点下

![image-20210719070843403](https://raw.githubusercontent.com/zmk-c/blogImages/master/img/%E6%A0%91%E7%8A%B6%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84.png)

- **/bin：**bin是Binary的缩写，这个目录存放着最经常使用的命令
- **/boot：**这里存放的是启动Linux时使用的一些核心文件，包括一些连接文件及镜像文件（**不要动**）
- **/dev：**dev是Device设备的缩写，存放的是Linux的外部设备，在Linux中访问设备的方式和访问文件的方式是相同的
- ==**/etc：**这个目录用来存放所有的系统管理所需要的配置文件和子目录==
- ==**/home：**用户的主目录，在Linux中，每个用户都有一个自己的目录，一般是用用户的账号命名的==
- **/lib：**这个目录里存放着系统最基本的动态连接共享库，其作用类似于Windows里的DLL文件（**不要动**）
- **/lost+found：**这个目录般情况下是空的,当系统非法关机后，这里就存放了一些文件
- **/media：**linux系统会自动识别一 些设备,例如U盘、光驱等等，当识别后，linux会把识别的设备**挂载**到这个目录下（**不怎么使用**）
- **/mnt：**系统提供该目录是为了让用户临时**挂载**别的文件系统的，我们可以将光驱挂载在/mnt/上,然后进入该目录就可以查看光驱里的内容了（后面会把一些本地文件挂载在这个目录下）
- ==**/opt：**这是给主机额外安装软件所摆放的目录。比如你安装-个ORACLE数据库则就可以放到这个目录下。 **默认是空的**==
- **/proc：**这个目录是一个虚拟的目录,它是系统内存的映射,我们可以通过直接访问这个目录来获取系统信息
- ==**/root：**该目录为系统管理员，也称作超级权限者的用户主目录==
- **/sbin：**s就是Super User的意思,这里存放的是系统管理员使用的系统管理程序
- **/srv：** 该目录存放一些服务启动之后需要提取的数据。
- **/sys：**这是linux2.6内核的一个很大的变化。该目录下安装了2.6内核中新出现的一个文件系统sysfs
- ==**/tmp：**这个目录是用来存放一些临时文件的。用完就丢的文件，可以放在这个目录下，安装包！==
- ==**/usr：**这是一个非常重要的目录，用户的很多应用程序和文件都放在这个目录下,类似于windows下的program files目录==
- **/usr/bin：**系统用户使用的应用程序
- **/usr/sbin：**超级用户使用的比较高级的管理程序和系统守护程序
- **/usr/src：**内核源代码默认的放置目录。
- **/var：**这个目录中存放着在不断扩充着的东西，我们习惯将那些**经常被修改的目录放在这个目录下，包括各种日志文件。**
- **/run：**是一个临时文件系统，存储系统启动以来的信息。当系统重启时，这个目录下的文件应该被删掉或清除（**不使用**）

### 文件内容查看

Linux系统中使用以下命令来查看文件的内容：

- `cat` 由第一行开始显示文件内容

- `tac` 从最后一行开始显示

- `nl` 显示的时候，输出行号

  ![image-20210720194236919](https://raw.githubusercontent.com/zmk-c/blogImages/master/img/20210720194237.png)

- `more` 一页一页的显示文件内容（空格表示翻页，enter 表示向下看一行，ctrl+b返回上一行，:f 行号）

- `less` 与more类似，向前翻页（按q退出，pageDown/pageUp代表翻动页面）
- `head` 只看头几行（head -行数 文件）

- `tail` 只看尾部几行
- `/` 在文件内容中进行查找（n寻找下一个，N寻找上一个）

可以使用使用`man`命令来查看各个命令的使用文档，如：man cp

查看网络配置文件

```shell
cat /etc/sysconfig/network-scripts/ifcfg-ehto0
```

### Linux 链接的概念

Linux 的链接分为两种：硬链接，软链接

**硬链接**

A---B：假设B是A的硬链接，那么他们两个指向同一个文件！允许一个文件拥有多个路径，用户可以通过这种机制建立硬链接到一些重要文件上，防止误删。

**软连接（符号链接）**

类似window下的快捷方式，删除源文件，快捷方式也没了。

<img src="https://raw.githubusercontent.com/zmk-c/blogImages/master/img/20210720200633.png" style="zoom: 50%;" />

### Vim 编辑器

vim通过一些插件可以实现和IDE一样的功能

vim是从vi发展出来的一个文本编辑器。代码补全，编译及错误跳转等方便编程的功能特别丰富。尤其是Linux中，必须要学会使用vim（查看内容，编辑内容，保持内容）

![img](https://raw.githubusercontent.com/zmk-c/blogImages/master/img/20210720201214.png)

| 按键       | 说明                                                    |
| ---------- | ------------------------------------------------------- |
| [ctrl]+[d] | 屏幕向下移动半页                                        |
| [ctrl]+[u] | 屏幕向上移动半页                                        |
| :set nu    | 设定行号                                                |
| :set nonu  | 取消行号                                                |
| yy         | 复制游标所在的那一行 **（常用）**                       |
| nyy        | n 为数字， 复制游标所在的那一行往下数 n 行 **（常用）** |

### 账号管理

Linux系统是一个**多用户多任务的分时操作系统**，任何一个要使用系统资源的用户，都必须首先向系统管理员申请一个账号,然后以这个账号的身份进入系统。

用户的账号一方面可以帮助系统管理员对使用系统的用户进行跟踪 ，并控制他们对系统资源的访问；另一方面也可以帮助用户组织文件,并为用户提供安全性保护。

每个用户账号都拥有一个唯一的用户名和各自的口令。

用户在登录时键入正确的用户名和口令后,就能够进入系统和自己的主目录。
实现用户账号的管理,要完成的工作主要有如下几个方面:

- 用户账号的添加、删除与修改。
- 用户口令的管理。
- 用户组的管理。

> 用户账号管理

```shell
useradd -选项 用户名
# -m 自动创建这个用户的主目录 /home/用户名 常用
# -G 指定用户组名
# 选项
-c comment 指定一段注释性描述。

-d 目录 指定用户主目录，如果此目录不存在，则同时使用-m选项，可以创建主目录。

-g 用户组 指定用户所属的用户组。

-G 用户组，用户组 指定用户所属的附加组。

-m　使用者目录如不存在则自动建立。

-s Shell文件 指定用户的登录Shell。

-u 用户号 指定用户的用户号，如果同时有-o选项，则可以重复使用其他用户的标识号。
```

理解一下本质：Linux中一切皆文件，这里添加用户说白了就是往某个文件中写入用户的信息`cat /etc/passwd`

![image-20210721070216812](C:\Users\zmkfm\AppData\Roaming\Typora\typora-user-images\image-20210721070216812.png)

> 删除用户

```shell
userdel -r 用户名
```

> 修改用户

```shell
usermod -选项 操作
#选项
-c comment 指定一段注释性描述。

-d 目录 指定用户主目录，如果此目录不存在，则同时使用-m选项，可以创建主目录。

-g 用户组 指定用户所属的用户组。

-G 用户组，用户组 指定用户所属的附加组。

-m　使用者目录如不存在则自动建立。

-s Shell文件 指定用户的登录Shell。

-u 用户号 指定用户的用户号，如果同时有-o选项，则可以重复使用其他用户的标识号。
```

> 切换用户

1. 切换用户的命令为：su username 【username是你的用户名哦】
2. 从普通用户切换到root用户，还可以使用命令：sudo su
3. 在终端输入exit或logout或使用快捷方式ctrl+d，可以退回到原来用户，其实ctrl+d也是执行的exit命令
4. 在切换用户时，如果想在切换用户之后使用新用户的工作环境，可以在su和username之间加-，例如：【su - root】

- $表示普通用户

- #表示超级用户，也就是root用户

> 修改主机名

```shell
hostname 主机名  # 临时的设置 修改后重新连接即可  重启后消失
vi /etc/hosts # 文件中修改主机名，永久有效
```

> 用户密码设置

我们一般通过root创建用户时需要配置密码

如果是超级用户

```shell
passwd 用户名 # 跟着提示添加新密码
```

如果是普通用户

```shell
passwd  # 跟着提示修改密码
```

> 锁定账号

```shell
passwd -l 用户名  # 锁定用户，改用户就不能登录了
passwd -u 用户名  # 解锁用户
passwd -d 用户名  # 没有密码也不能登录
```

### 用户组管理

每个用户都有一个用户组，系统可以对一个用户组中的所有用户进行集中管理。不同Linux 系统对用户组的规定有所不同，如Linux下的用户属于与它同名的用户组，这个用户组在创建用户时同时创建。

用户组的管理涉及用户组的添加、删除和修改。组的增加、删除和修改实际上就是对`/etc/group`文件的更新。

> 创建一个用户组

```shell
groupadd -选项 组名
# 可以使用的选项有：
-g GID 指定新用户组的组标识号（GID），不指定为当前最大id值+1

-o 一般与-g选项同时使用，表示新用户组的GID可以与系统已有用户组的GID相同
```

> 删除用户组

```shell
groupdel 组名
```

> 修改用户组

```shell
groupmod -选项 组名
#常用的选项有：
-g GID 为用户组指定新的组标识号。

-o 与-g选项同时使用，用户组的新GID可以与系统已有用户组的GID相同。

-n 更改组名
```

> 用户切换用户组

如果一个用户同时属于多个用户组，那么用户可以在用户组之间切换，以便具有其他用户组的权限。

用户可以在登录后，使用命令newgrp切换到其他用户组，这个命令的参数就是目的用户组。

```shell
#登录当前用户 zmk
newgrp root
```

> 拓展

/etc/passwd中一行记录对应着一个用户，每行记录又被冒号(:)分隔为7个字段，其格式和具体含义如下：

```
用户名:口令(登录密码，我们不可见，密码在/etc/shadow目录下):用户标识号:组标识号:注释性描述:主目录:登录Shell
```

![image-20210721075220906](C:\Users\zmkfm\AppData\Roaming\Typora\typora-user-images\image-20210721075220906.png)

### 磁盘管理

`df 列出文件系统整体的磁盘使用量`

```shell
# df -h [目录名称]		转换成易读的格式（将字节转换成M）
[root@aliyun ~]# df -h
Filesystem      Size  Used Avail Use% Mounted on
/dev/vda1        40G  4.6G   33G  13% /
devtmpfs        909M     0  909M   0% /dev
tmpfs           919M     0  919M   0% /dev/shm
tmpfs           919M  636K  919M   1% /run
tmpfs           919M     0  919M   0% /sys/fs/cgroup
overlay          40G  4.6G   33G  13% /var/lib/docker/overlay2/e7ee66ab0f496c03a39cbc2e94bc2521820a7adc0a2df5f3ce34b82f57eeacf5/merged
tmpfs           184M     0  184M   0% /run/user/0
```

`du 对文件和目录磁盘使用的空间的查看`

```shell
#选项与参数
-a ：列出所有的文件与目录容量，因为默认仅统计目录底下的文件量而已。

-h ：以人们较易读的容量格式 (G/M) 显示；

-s ：列出总量而已，而不列出每个各别的目录占用容量；

-S ：不包括子目录下的总计，与 -s 有点差别。

-k ：以 KBytes 列出容量显示；

-m ：以 MBytes 列出容量显示；
```

### 进程管理

> 什么是进程

1. 在linux中，每一个程序都是有自己的一个进程，每一个进程都有一个id号
2. 每一个进程都有一个父进程
3. 进程可以有两种存在方式：前台/后台运行
4. 一般服务都是后台运行的，基本的程序都是前台运行的

> 命令

`ps` 查看当前系统中正在执行的各种进程信息

ps -xxx:

- -a 显示当前终端运行的所有的进程信息
- -u 以用户的信息显示进程
- -x 显示后台运行进程的参数

```shell
ps -aux | grep mysql
# | 在linux中这个叫管道符   A | B
# grep 查找文件中符合条件的字符串
```

对于我们来说，这里目前只需要记住一个命令即可 `ps -xx | grep 进程名字`过滤进程信息

`ps -ef` 可以看到父进程的信息

```shell
ps -ef | grep mysql # 看父进程我们一般通过目录树结构来查看
pstree -pu # -p 显示父进程号 -u 显示用户组
```

![image-20210721131642134](https://raw.githubusercontent.com/zmk-c/blogImages/master/img/20210721131642.png)

结束进程：杀掉进程，等于windows结束任务`kill -9 进程id` 表示强制结束

